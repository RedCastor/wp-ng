!function(){"use strict";function e(){return++c}function t(e){return e&&e.window===e}function n(e){return"string"==typeof e}function a(e){if(null==e||t(e))return!1;var a=e.length;return!(1!==e.nodeType||!a)||(n(e)||Array.isArray(e)||0===a||"number"==typeof a&&a>0&&a-1 in e)}function l(){return Object.create(null)}function r(t,n){var a,l=typeof t;return"function"==l||"object"==l&&null!==t?"function"==typeof(a=t.$$hashKey)?a=t.$$hashKey():void 0===a&&(a=t.$$hashKey=(n||e)()):a=t,l+":"+a}function s(e,t,n){var a,l,r=[],s=[];for(a=0;a<t.length;a++)for(l=0;l<e.length;l++)e[l][n]?e[l][n]===t[a]&&s.push(e[l]):r.push(e[l]);return s=s.concat(r)}function o(e){var t=e[0],n=e[e.length-1],a=[t];do{if(t=t.nextSibling,!t)break;a.push(t)}while(t!==n);return angular.element(a)}function i(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}var c=0,d=function(e){return e.clone[0]},u=function(e){return e.clone[e.clone.length-1]},p=function(e,t,n,a,l,r,s,o){e[n]=a,l&&(e[l]=r),e.$index=t,e.$first=0===t,e.$last=t===s-1,e.$middle=!(e.$first||e.$last),e.$odd=!(e.$even=0===(1&t)),o&&(e.$group=o)},f=function(e,t){e.data("isolateScope",t)},h=function(e,t){var n,a=e.length;if(0===a)return!1;for(n=0;n<a;n++)if(S(t,e[n]))return!0;return!1},v=function(e,t){var n,a=e.length;if(0===a)return-1;for(n=0;n<a;n++)if(S(t,e[n]))return n;return-1},g=function(e,t,n){var a,l=e,r=typeof n;if(e==t)return null;do if("string"===r){if(a=" "+l.className+" ",1===l.nodeType&&a.replace(/[\t\r\n\f]/g," ").indexOf(n)>=0)return l}else if(l==n)return l;while((l=l.parentNode)&&l!=t&&9!==l.nodeType);return null},C=function(e){var t,n=e.className.replace(/[\t\r\n\f]/g," ").trim();t=n.split(" ");for(var a=0;a<t.length;a++)/\s+/.test(t[a])&&(t.splice(a,1),a--);return t},m=function(e,t){var n=C(e);return n.indexOf(t)!==-1},y=function(e,t){var n,a,l;if(e.text().toLowerCase().indexOf(t.toLowerCase())!==-1)return!0;for(n=e.children(),l=n.length,a=0;a<l;a++)if(n.eq(a).text().toLowerCase().indexOf(t.toLowerCase())!==-1)return!0;return!1},b=angular.element,S=angular.equals,$=angular.copy,w=angular.extend,T=angular.module("nya.bootstrap.select",[]);T.provider("nyaBsConfig",function(){var e=null,t={"en-us":{defaultNoneSelection:"Nothing selected",noSearchResult:"NO SEARCH RESULT",numberItemSelected:"%d items selected",selectAll:"Select All",deselectAll:"Deselect All"}},n=$(t);this.setLocalizedText=function(e,t){if(!e)throw new Error("localeId must be a string formatted as languageId-countryId");n[e]||(n[e]={}),n[e]=w(n[e],t)},this.useLocale=function(t){e=t},this.$get=["$locale",function(a){var l;return l=e?n[e]:n[a.id],l||(l=t["en-us"]),l}]}),T.controller("nyaBsSelectCtrl",function(){var e=this;e.keyIdentifier=null,e.valueIdentifier=null,e.isMultiple=!1,e.onCollectionChange=function(){},e.setId=function(t){e.id=t||"id#"+Math.floor(1e4*Math.random())}}),T.directive("nyaBsSelect",["$parse","$document","$timeout","$compile","nyaBsConfig",function(e,t,n,a,l){var r="Nothing selected",s='<button class="btn btn-default dropdown-toggle" type="button"><span class="pull-left filter-option"></span><span class="pull-left special-title"></span>&nbsp;<span class="caret"></span></button>',o='<div class="dropdown-menu open"></div>',c='<div class="bs-searchbox"><input type="text" class="form-control"></div>',d='<ul class="dropdown-menu inner"></ul>',u='<li class="no-search-result"><span>NO SEARCH RESULT</span></li>',p='<div class="bs-actionsbox"><div class="btn-group btn-group-sm btn-block"><button type="button" class="actions-btn bs-select-all btn btn-default">SELECT ALL</button><button type="button" class="actions-btn bs-deselect-all btn btn-default">DESELECT ALL</button></div></div>';return{restrict:"ECA",require:["ngModel","nyaBsSelect"],controller:"nyaBsSelectCtrl",compile:function(f,w){f.addClass("btn-group");var T,x,A,q,E,N,L,k,I=function(e){var t;return t=w.titleTpl?b(w.titleTpl):w.title?document.createTextNode(w.title):H.defaultNoneSelectionTpl?b(H.defaultNoneSelectionTpl):H.defaultNoneSelection?document.createTextNode(H.defaultNoneSelection):document.createTextNode(r),e&&(w.titleTpl||H.defaultNoneSelectionTpl)?a(t)(e):t},R=f.children(),O=b(s),V=b(o),B=b(d),H=l,P="undefined"!=typeof w.multiple;for(q=C(f[0]),q.forEach(function(e){/btn-(?:primary|info|success|warning|danger|inverse)/.test(e)&&(f.removeClass(e),O.removeClass("btn-default"),O.addClass(e)),/btn-(?:lg|sm|xs)/.test(e)&&(f.removeClass(e),O.addClass(e))}),B.append(R),E=R.length,N=0;N<E;N++)L=R.eq(N),(L.hasClass("nya-bs-option")||L.attr("nya-bs-option"))&&(L.find("a").attr("tabindex","0"),k=L.attr("value"),angular.isString(k)&&""!==k&&(L.attr("data-value",k),L.removeAttr("value")));return"true"===w.liveSearch&&(T=b(c),w.noSearchTitle?u=u.replace("NO SEARCH RESULT",w.noSearchTitle):w.noSearchTitleTpl?u=u.replace("NO SEARCH RESULT",w.noSearchTitleTpl):H.noSearchResultTpl?u=u.replace("NO SEARCH RESULT",H.noSearchResultTpl):H.noSearchResult&&(u=u.replace("NO SEARCH RESULT",H.noSearchResult)),x=b(u),V.append(T),B.append(x)),"true"===w.actionsBox&&P&&(H.selectAllTpl?p=p.replace("SELECT ALL",H.selectAllTpl):H.selectAll&&(p=p.replace("SELECT ALL",H.selectAll)),H.deselectAllTpl?p=p.replace("DESELECT ALL",H.deselectAllTpl):H.selectAll&&(p=p.replace("DESELECT ALL",H.deselectAll)),A=b(p),V.append(A)),b(O[0].querySelector(".special-title")).append(I()),V.append(B),f.append(O),f.append(V),function(l,r,s,o){function c(){var e,t,n=P.children(),a=n.length;for(e=0;e<a;e++)if(t=n.eq(e),t.hasClass("active")&&t.hasClass("nya-bs-option")&&!t.hasClass("not-match"))return t;return null}function d(e){for(var t,n=e.childNodes,a=n.length,l=0;l<a;l++)if(t=n[l],1===t.nodeType&&"a"===t.tagName.toLowerCase()){t.focus();break}}function u(e){var t;t=e?P.children().eq(0):P.children().eq(P.children().length-1);for(var n=0;n<P.children().length;n++){var a=P.children().eq(n);if(!a.hasClass("not-match")&&a.hasClass("selected"))return P.children().eq(n)[0]}return!t.hasClass("nya-bs-option")||t.hasClass("disabled")||t.hasClass("not-match")?e?p(t[0],"nextSibling"):p(t[0],"previousSibling"):t[0]}function p(e,t){if(!e||m(e,"nya-bs-option")){for(var n=e;(n=i(n,t))&&n.nodeType;)if(m(n,"nya-bs-option")&&!m(n,"disabled")&&!m(n,"not-match"))return n;return null}}function f(e){if(O&&!I){var t,n,a;if(t=P[0].querySelectorAll(".nya-bs-option"),t.length>0){n=L.$viewValue,a=Array.isArray(n)?$(n):[];for(var r=0;r<t.length;r++){var s=b(t[r]);if(!s.hasClass("disabled")){var o,i;o=w(s),"undefined"!=typeof o&&(i=v(a,o),e&&i==-1?(a.push(o),s.addClass("selected")):e||i==-1||(a.splice(i,1),s.removeClass("selected")))}}L.$setViewValue(a),l.$digest(),x()}}}function C(e){var t,n,a,s=L.$viewValue;t=w(e),"undefined"!=typeof t&&(O?(n=Array.isArray(s)?$(s):[],a=v(n,t),a===-1?(n.push(t),e.addClass("selected")):(n.splice(a,1),e.removeClass("selected"))):(P.children().removeClass("selected"),n=t,e.addClass("selected"))),L.$setViewValue(n),l.$digest(),O||(r.hasClass("open")&&r.triggerHandler("blur"),r.removeClass("open"),V[0].focus()),x()}function w(e){var t;return N?(t=e.data("isolateScope"),N(t)):k.valueIdentifier||k.keyIdentifier?(t=e.data("isolateScope"),t[k.valueIdentifier]||t[k.keyIdentifier]):e.attr("data-value")}function T(e){var t=e.find("a");return 0===t.children().length||t.children().eq(0).hasClass("check-mark")?t[0].firstChild.cloneNode(!1):t.children().eq(0)[0].cloneNode(!0)}function x(){var e=L.$viewValue;r.triggerHandler("change");var t=b(V[0].querySelector(".filter-option"));b(V[0].querySelector(".special-title"));return"undefined"==typeof e?(V.addClass("show-special-title"),void t.empty()):void(O&&0===e.length?(V.addClass("show-special-title"),t.empty()):(V.removeClass("show-special-title"),n(function(){var n,l,r,o,i,c,d,u=P.children(),p=u.length,f=[],v=[];if(O&&"count"===s.selectedTextFormat?c=1:O&&s.selectedTextFormat&&(i=s.selectedTextFormat.match(/\s*count\s*>\s*(\d+)\s*/))&&(c=parseInt(i[1],10)),"undefined"!=typeof c&&e.length>c)return t.empty(),void(H.numberItemSelectedTpl?t.append(b(H.numberItemSelectedTpl.replace("%d",e.length))):H.numberItemSelected?t.append(document.createTextNode(H.numberItemSelected.replace("%d",e.length))):t.append(document.createTextNode(e.length+" items selected")));for(r=0;r<p;r++)l=u.eq(r),l.hasClass("nya-bs-option")&&(n=w(l),O?Array.isArray(e)&&h(e,n)&&(o=l.attr("title"),o?f.push(document.createTextNode(o)):(f.push(T(l)),v.push(l.data("isolateScope")))):S(e,n)&&(o=l.attr("title"),o?f.push(document.createTextNode(o)):(f.push(T(l)),v.push(l.data("isolateScope")))));if(0===f.length)t.empty(),V.addClass("show-special-title");else if(1===f.length)V.removeClass("show-special-title"),t.empty(),d=v[0]?a(f[0])(v[0]):f[0],t.append(d);else for(V.removeClass("show-special-title"),t.empty(),r=0;r<f.length;r++)d=v[r]?a(f[r])(v[r]):f[r],t.append(d),r<f.length-1&&t.append(document.createTextNode(", "))})))}function A(){var e,t,n=P.find("li"),a=n.length;for(t=0;t<a;t++)if(e=n.eq(t),e.hasClass("nya-bs-option")||e.attr("nya-bs-option")){q=e[0].clientHeight;break}if(/\d+/.test(s.size)){var l=parseInt(s.size,10);P.css("max-height",l*q+"px"),P.css("overflow-y","auto")}}var q,E,N,L=o[0],k=o[1],I=!1,R=e(k.valueExp),O="undefined"!=typeof s.multiple,V=b(r[0].querySelector(".dropdown-toggle")),B=V.next(),P=b(B[0].querySelector(".dropdown-menu.inner")),D=b(B[0].querySelector(".bs-searchbox")),M=b(P[0].querySelector(".no-search-result")),U=b(B[0].querySelector(".bs-actionsbox"));k.valueExp&&(N=function(e,t){return R(e,t)}),k.setId(r.attr("id")),O&&(k.isMultiple=!0,L.$isEmpty=function(e){return!e||0===e.length}),"undefined"!=typeof s.disabled&&l.$watch(s.disabled,function(e){e?(V.addClass("disabled"),V.attr("disabled","disabled"),E=V.attr("tabindex"),V.attr("tabindex","-1"),I=!0):(V.removeClass("disabled"),V.removeAttr("disabled"),E?V.attr("tabindex",E):V.removeAttr("tabindex"),I=!1)}),k.onCollectionChange=function(e,t){var n,a=[],r=!1,s=$(L.$modelValue);if(s){if(Array.isArray(e)&&e.length>0){if(N)for(n=0;n<e.length;n++)a.push(N(l,e[n]));else for(n=0;n<e.length;n++)k.valueIdentifier?a.push(e[n][k.valueIdentifier]):k.keyIdentifier&&a.push(e[n][k.keyIdentifier]);if(O){for(n=0;n<s.length;n++)h(a,s[n])||(r=!0,s.splice(n,1),n--);r&&(L.$setViewValue(s),x())}else h(a,s)||(s=a[0],L.$setViewValue(s),x())}t&&x()}},P.on("click",function(e){if(!I&&!b(e.target).hasClass("dropdown-header")){var t,n=g(e.target,P[0],"nya-bs-option");if(null!==n){if(t=b(n),t.hasClass("disabled"))return;C(t)}}});var z=function(e){null===g(e.target,r.parent()[0],r[0])&&(r.hasClass("open")&&r.triggerHandler("blur"),r.removeClass("open"))};t.on("click",z),V.on("blur",function(){r.hasClass("open")||r.triggerHandler("blur")}),V.on("click",function(){var e;r.toggleClass("open"),r.hasClass("open")&&"undefined"==typeof q&&A(),"true"===s.liveSearch&&r.hasClass("open")?(D.children().eq(0)[0].focus(),e=u(!0),e&&(P.children().removeClass("active"),b(e).addClass("active"))):r.hasClass("open")&&(e=u(!0),e&&d(e))}),"true"===s.actionsBox&&O&&(U.find("button").eq(0).on("click",function(){f(!0)}),U.find("button").eq(1).on("click",function(){f(!1)})),"true"===s.liveSearch&&D.children().on("input",function(){var e,t,n,a=D.children().val(),l=0,r=P.children(),s=r.length;if(a){for(e=0;e<s;e++)t=r.eq(e),t.hasClass("nya-bs-option")&&(y(t.find("a"),a)?(t.removeClass("not-match"),l++):t.addClass("not-match"));0===l?M.addClass("show"):M.removeClass("show")}else{for(e=0;e<s;e++)t=r.eq(e),t.hasClass("nya-bs-option")&&t.removeClass("not-match");M.removeClass("show")}n=u(!0),n&&(r.removeClass("active"),b(n).addClass("active"))}),L.$render=function(){var e,t,n=L.$modelValue,a=P.children(),l=a.length;if("undefined"==typeof n)for(e=0;e<l;e++)a.eq(e).hasClass("nya-bs-option")&&a.eq(e).removeClass("selected");else for(e=0;e<l;e++)a.eq(e).hasClass("nya-bs-option")&&(t=w(a.eq(e)),O?h(n,t)?a.eq(e).addClass("selected"):a.eq(e).removeClass("selected"):S(n,t)?a.eq(e).addClass("selected"):a.eq(e).removeClass("selected"));x()},r.on("keydown",function(e){var t=e.keyCode;if(27===t||13===t||38===t||40===t){if(e.preventDefault(),I)return void e.stopPropagation();var n,a,l,o,i=g(e.target,r[0],V[0]);"true"===s.liveSearch?a=g(e.target,r[0],D[0]):n=g(e.target,r[0],B[0]),i?13!==t&&38!==t&&40!==t||r.hasClass("open")||(e.stopPropagation(),r.addClass("open"),"undefined"==typeof q&&A(),"true"===s.liveSearch?(D.children().eq(0)[0].focus(),o=u(!0),o&&(P.children().removeClass("active"),b(o).addClass("active"))):(o=u(!0),o&&d(o))):n?27===t?(V[0].focus(),r.hasClass("open")&&r.triggerHandler("blur"),r.removeClass("open"),e.stopPropagation()):38===t?(e.stopPropagation(),o=p(e.target.parentNode,"previousSibling"),o?d(o):(o=u(!1),o&&d(o))):40===t?(e.stopPropagation(),o=p(e.target.parentNode,"nextSibling"),o?d(o):(o=u(!0),o&&d(o))):13===t&&(e.stopPropagation(),l=b(e.target.parentNode),l.hasClass("nya-bs-option")&&(C(l),O||V[0].focus())):a&&(27===t?(V[0].focus(),r.removeClass("open"),e.stopPropagation()):38===t?(e.stopPropagation(),l=c(),l&&(o=p(l[0],"previousSibling"),o?(l.removeClass("active"),b(o).addClass("active")):(o=u(!1),o&&(l.removeClass("active"),b(o).addClass("active"))))):40===t?(e.stopPropagation(),l=c(),l&&(o=p(l[0],"nextSibling"),o?(l.removeClass("active"),b(o).addClass("active")):(o=u(!0),o&&(l.removeClass("active"),b(o).addClass("active"))))):13===t&&(l=c(),l&&(C(l),O||V[0].focus())))}}),l.$on("$destroy",function(){P.off(),V.off(),D.off&&D.off(),t.off("click",z)})}}}}]),T.directive("nyaBsOption",["$parse",function(e){var t=/^\s*(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/;return{restrict:"A",transclude:"element",priority:1e3,terminal:!0,require:["^nyaBsSelect","^ngModel"],compile:function(n,i){var c=i.nyaBsOption,v=document.createComment(" end nyaBsOption: "+c+" "),g=c.match(t);if(!g)throw new Error("invalid expression");var C,m,y,$,w,T=i.value,x=T?e(T):null,A=g[3]||g[1],q=g[2],E=g[4],N=g[5]?e(g[5]):null,L=g[6],k={$id:r},I={};return L?$=e(L):(C=function(e,t){return r(t)},m=function(e){return e}),function(e,t,n,r,i){function c(e){var n,r,c,$,T,x,E,N,k,I,V,H,P,D,M,U=t[0],z=l(),F=[];if(w&&(H=[]),a(e))x=e,T=y||C;else{T=y||m,x=[];for(var K in e)e.hasOwnProperty(K)&&"$"!=K.charAt(0)&&x.push(K);x.sort()}for(E=x.length,N=new Array(E),n=0;n<E;n++)if(r=e===x?n:x[n],c=e[r],$=T(r,c,n),M={},q&&(M[q]=r),M[A]=c,F.push(M),w&&(I=w(r,c),H.indexOf(I)===-1&&I&&H.push(I)),B[$])k=B[$],delete B[$],w&&(k.group=I),k.key=r,k.value=c,z[$]=k,N[n]=k;else{if(z[$])throw N.forEach(function(e){e&&e.scope&&(B[e.id]=e)}),new Error("Duplicates in a select are not allowed. Use 'track by' expression to specify unique keys.");N[n]={id:$,scope:void 0,clone:void 0,key:r,value:c},z[$]=!0,I&&(N[n].group=I)}H&&H.length>0&&(N=s(N,H,"group"));for(var j in B)k=B[j],D=o(k.clone),D.removeData("isolateScope"),D.remove(),k.scope.$destroy();for(n=0;n<E;n++)k=N[n],k.scope?(V=U,d(k)!=V&&b(U).after(k.clone),U=u(k),p(k.scope,n,A,k.value,q,k.key,E,k.group)):i(function(e,t){f(e,t),k.scope=t;var a=v.cloneNode(!1);e[e.length++]=a,b(U).after(e),e.addClass("nya-bs-option"),c=g?g(k.key,k.value):k.value||k.key,R.isMultiple?Array.isArray(O.$modelValue)&&h(O.$modelValue,c)&&e.addClass("selected"):S(c,O.$modelValue)&&e.addClass("selected"),U=a,k.clone=e,z[k.id]=k,p(k.scope,n,A,k.value,q,k.key,E,k.group)}),H&&(P&&P===k.group?k.clone.removeClass("first-in-group"):k.clone.addClass("first-in-group"),P=k.group,k.clone.addClass("group-item"));B=z,R.onCollectionChange(F,L)}var g,L,R=r[0],O=r[1],V={};$&&(y=function(t,n,a){return q&&(k[q]=t),k[A]=n,k.$index=a,$(e,k)}),N&&(w=function(t,n){return q&&(I[q]=t),I[A]=n,N(e,I)}),q&&(R.keyIdentifier=q),A&&(R.valueIdentifier=A),x&&(R.valueExp=T,g=function(t,n){return q&&(V[q]=t),V[A]=n,x(e,V)});var B=l();"true"===n.deepWatch?(L=!0,e.$watch(E,c,!0)):(L=!1,e.$watchCollection(E,c))}}}}])}();